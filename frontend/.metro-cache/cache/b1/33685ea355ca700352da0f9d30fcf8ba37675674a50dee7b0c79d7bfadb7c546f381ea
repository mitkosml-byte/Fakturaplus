{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":88,"index":88}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../stores/authStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":89},"end":{"line":2,"column":51,"index":140}}],"key":"xZ94Y9XSSJKgtl1T0/yiI2QWZsY=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/contexts/AuthContext.tsx\"; // Role hierarchy: owner > manager > staff\n  // Permission types\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _storesAuthStore = require(_dependencyMap[1], \"../stores/authStore\");\n  var _reactJsxDevRuntime = require(_dependencyMap[2], \"react/jsx-dev-runtime\");\n  // Add expenses\n\n  // Role-permission matrix\n  const rolePermissions = {\n    owner: ['manage_users', 'manage_company', 'view_audit_log', 'manage_budget', 'export_data', 'view_statistics', 'manage_invoices', 'add_revenue', 'add_expenses'],\n    manager: ['manage_budget', 'export_data', 'view_statistics', 'manage_invoices', 'add_revenue', 'add_expenses'],\n    staff: ['manage_invoices', 'add_revenue', 'add_expenses']\n  };\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider({\n    children\n  }) {\n    const {\n      user,\n      isLoading,\n      isAuthenticated,\n      login,\n      logout,\n      checkAuth,\n      refreshUser,\n      setUser\n    } = (0, _storesAuthStore.useAuthStore)();\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, []);\n\n    // Role-based permission helpers\n    const roleHelpers = (0, _react.useMemo)(() => {\n      const userRole = user?.role || 'staff';\n      const hasPermission = permission => {\n        if (!user) return false;\n        const permissions = rolePermissions[userRole] || [];\n        return permissions.includes(permission);\n      };\n      const hasRole = role => {\n        if (!user) return false;\n        const roleHierarchy = ['owner', 'manager', 'staff'];\n        const userRoleIndex = roleHierarchy.indexOf(userRole);\n        const requiredRoleIndex = roleHierarchy.indexOf(role);\n        return userRoleIndex <= requiredRoleIndex;\n      };\n      return {\n        hasPermission,\n        hasRole,\n        isOwner: userRole === 'owner',\n        isManager: userRole === 'manager',\n        isStaff: userRole === 'staff'\n      };\n    }, [user]);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        isAuthenticated,\n        login,\n        logout,\n        refreshUser,\n        setUser,\n        ...roleHelpers\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }, this);\n  }\n  function useAuth() {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n});","lineCount":88,"map":[[4,67,5,0],[5,2,8,0],[6,2,8,0,"Object"],[6,8,8,0],[6,9,8,0,"defineProperty"],[6,23,8,0],[6,24,8,0,"exports"],[6,31,8,0],[7,4,8,0,"value"],[7,9,8,0],[8,2,8,0],[9,2,66,0,"exports"],[9,9,66,0],[9,10,66,0,"AuthProvider"],[9,22,66,0],[9,25,66,0,"AuthProvider"],[9,37,66,0],[10,2,116,0,"exports"],[10,9,116,0],[10,10,116,0,"useAuth"],[10,17,116,0],[10,20,116,0,"useAuth"],[10,27,116,0],[11,2,1,0],[11,6,1,0,"_react"],[11,12,1,0],[11,15,1,0,"require"],[11,22,1,0],[11,23,1,0,"_dependencyMap"],[11,37,1,0],[12,2,2,0],[12,6,2,0,"_storesAuthStore"],[12,22,2,0],[12,25,2,0,"require"],[12,32,2,0],[12,33,2,0,"_dependencyMap"],[12,47,2,0],[13,2,2,51],[13,6,2,51,"_reactJsxDevRuntime"],[13,25,2,51],[13,28,2,51,"require"],[13,35,2,51],[13,36,2,51,"_dependencyMap"],[13,50,2,51],[14,2,18,24],[16,2,20,0],[17,2,21,0],[17,8,21,6,"rolePermissions"],[17,23,21,53],[17,26,21,56],[18,4,22,2,"owner"],[18,9,22,7],[18,11,22,9],[18,12,23,4],[18,26,23,18],[18,28,24,4],[18,44,24,20],[18,46,25,4],[18,62,25,20],[18,64,26,4],[18,79,26,19],[18,81,27,4],[18,94,27,17],[18,96,28,4],[18,113,28,21],[18,115,29,4],[18,132,29,21],[18,134,30,4],[18,147,30,17],[18,149,31,4],[18,163,31,18],[18,164,32,3],[19,4,33,2,"manager"],[19,11,33,9],[19,13,33,11],[19,14,34,4],[19,29,34,19],[19,31,35,4],[19,44,35,17],[19,46,36,4],[19,63,36,21],[19,65,37,4],[19,82,37,21],[19,84,38,4],[19,97,38,17],[19,99,39,4],[19,113,39,18],[19,114,40,3],[20,4,41,2,"staff"],[20,9,41,7],[20,11,41,9],[20,12,42,4],[20,29,42,21],[20,31,43,4],[20,44,43,17],[20,46,44,4],[20,60,44,18],[21,2,46,0],[21,3,46,1],[22,2,64,0],[22,8,64,6,"AuthContext"],[22,19,64,17],[22,35,64,20],[22,39,64,20,"createContext"],[22,45,64,33],[22,46,64,33,"createContext"],[22,59,64,33],[22,61,64,63,"undefined"],[22,70,64,72],[22,71,64,73],[23,2,66,7],[23,11,66,16,"AuthProvider"],[23,23,66,28,"AuthProvider"],[23,24,66,29],[24,4,66,31,"children"],[25,2,66,65],[25,3,66,66],[25,5,66,68],[26,4,67,2],[26,10,67,8],[27,6,67,10,"user"],[27,10,67,14],[28,6,67,16,"isLoading"],[28,15,67,25],[29,6,67,27,"isAuthenticated"],[29,21,67,42],[30,6,67,44,"login"],[30,11,67,49],[31,6,67,51,"logout"],[31,12,67,57],[32,6,67,59,"checkAuth"],[32,15,67,68],[33,6,67,70,"refreshUser"],[33,17,67,81],[34,6,67,83,"setUser"],[35,4,67,91],[35,5,67,92],[35,8,67,95],[35,12,67,95,"useAuthStore"],[35,28,67,107],[35,29,67,107,"useAuthStore"],[35,41,67,107],[35,43,67,108],[35,44,67,109],[36,4,69,2],[36,8,69,2,"useEffect"],[36,14,69,11],[36,15,69,11,"useEffect"],[36,24,69,11],[36,26,69,12],[36,32,69,18],[37,6,70,4,"checkAuth"],[37,15,70,13],[37,16,70,14],[37,17,70,15],[38,4,71,2],[38,5,71,3],[38,7,71,5],[38,9,71,7],[38,10,71,8],[40,4,73,2],[41,4,74,2],[41,10,74,8,"roleHelpers"],[41,21,74,19],[41,24,74,22],[41,28,74,22,"useMemo"],[41,34,74,29],[41,35,74,29,"useMemo"],[41,42,74,29],[41,44,74,30],[41,50,74,36],[42,6,75,4],[42,12,75,10,"userRole"],[42,20,75,18],[42,23,75,22,"user"],[42,27,75,26],[42,29,75,28,"role"],[42,33,75,32],[42,37,75,36],[42,44,75,56],[43,6,77,4],[43,12,77,10,"hasPermission"],[43,25,77,23],[43,28,77,27,"permission"],[43,38,77,49],[43,42,77,63],[44,8,78,6],[44,12,78,10],[44,13,78,11,"user"],[44,17,78,15],[44,19,78,17],[44,26,78,24],[44,31,78,29],[45,8,79,6],[45,14,79,12,"permissions"],[45,25,79,23],[45,28,79,26,"rolePermissions"],[45,43,79,41],[45,44,79,42,"userRole"],[45,52,79,50],[45,53,79,51],[45,57,79,55],[45,59,79,57],[46,8,80,6],[46,15,80,13,"permissions"],[46,26,80,24],[46,27,80,25,"includes"],[46,35,80,33],[46,36,80,34,"permission"],[46,46,80,44],[46,47,80,45],[47,6,81,4],[47,7,81,5],[48,6,83,4],[48,12,83,10,"hasRole"],[48,19,83,17],[48,22,83,21,"role"],[48,26,83,35],[48,30,83,49],[49,8,84,6],[49,12,84,10],[49,13,84,11,"user"],[49,17,84,15],[49,19,84,17],[49,26,84,24],[49,31,84,29],[50,8,85,6],[50,14,85,12,"roleHierarchy"],[50,27,85,37],[50,30,85,40],[50,31,85,41],[50,38,85,48],[50,40,85,50],[50,49,85,59],[50,51,85,61],[50,58,85,68],[50,59,85,69],[51,8,86,6],[51,14,86,12,"userRoleIndex"],[51,27,86,25],[51,30,86,28,"roleHierarchy"],[51,43,86,41],[51,44,86,42,"indexOf"],[51,51,86,49],[51,52,86,50,"userRole"],[51,60,86,58],[51,61,86,59],[52,8,87,6],[52,14,87,12,"requiredRoleIndex"],[52,31,87,29],[52,34,87,32,"roleHierarchy"],[52,47,87,45],[52,48,87,46,"indexOf"],[52,55,87,53],[52,56,87,54,"role"],[52,60,87,58],[52,61,87,59],[53,8,88,6],[53,15,88,13,"userRoleIndex"],[53,28,88,26],[53,32,88,30,"requiredRoleIndex"],[53,49,88,47],[54,6,89,4],[54,7,89,5],[55,6,91,4],[55,13,91,11],[56,8,92,6,"hasPermission"],[56,21,92,19],[57,8,93,6,"hasRole"],[57,15,93,13],[58,8,94,6,"isOwner"],[58,15,94,13],[58,17,94,15,"userRole"],[58,25,94,23],[58,30,94,28],[58,37,94,35],[59,8,95,6,"isManager"],[59,17,95,15],[59,19,95,17,"userRole"],[59,27,95,25],[59,32,95,30],[59,41,95,39],[60,8,96,6,"isStaff"],[60,15,96,13],[60,17,96,15,"userRole"],[60,25,96,23],[60,30,96,28],[61,6,97,4],[61,7,97,5],[62,4,98,2],[62,5,98,3],[62,7,98,5],[62,8,98,6,"user"],[62,12,98,10],[62,13,98,11],[62,14,98,12],[63,4,100,2],[63,24,101,4],[63,28,101,4,"_reactJsxDevRuntime"],[63,47,101,4],[63,48,101,4,"jsxDEV"],[63,54,101,4],[63,56,101,5,"AuthContext"],[63,67,101,16],[63,68,101,17,"Provider"],[63,76,101,25],[64,6,101,26,"value"],[64,11,101,31],[64,13,101,33],[65,8,102,6,"user"],[65,12,102,10],[66,8,103,6,"isLoading"],[66,17,103,15],[67,8,104,6,"isAuthenticated"],[67,23,104,21],[68,8,105,6,"login"],[68,13,105,11],[69,8,106,6,"logout"],[69,14,106,12],[70,8,107,6,"refreshUser"],[70,19,107,17],[71,8,108,6,"setUser"],[71,15,108,13],[72,8,109,6],[72,11,109,9,"roleHelpers"],[73,6,110,4],[73,7,110,6],[74,6,110,6,"children"],[74,14,110,6],[74,16,111,7,"children"],[75,4,111,15],[76,6,111,15,"fileName"],[76,14,111,15],[76,16,111,15,"_jsxFileName"],[76,28,111,15],[77,6,111,15,"lineNumber"],[77,16,111,15],[78,6,111,15,"columnNumber"],[78,18,111,15],[79,4,111,15],[79,11,112,26],[79,12,112,27],[80,2,114,0],[81,2,116,7],[81,11,116,16,"useAuth"],[81,18,116,23,"useAuth"],[81,19,116,23],[81,21,116,26],[82,4,117,2],[82,10,117,8,"context"],[82,17,117,15],[82,20,117,18],[82,24,117,18,"useContext"],[82,30,117,28],[82,31,117,28,"useContext"],[82,41,117,28],[82,43,117,29,"AuthContext"],[82,54,117,40],[82,55,117,41],[83,4,118,2],[83,8,118,6,"context"],[83,15,118,13],[83,20,118,18,"undefined"],[83,29,118,27],[83,31,118,29],[84,6,119,4],[84,12,119,10],[84,16,119,14,"Error"],[84,21,119,19],[84,22,119,20],[84,67,119,65],[84,68,119,66],[85,4,120,2],[86,4,121,2],[86,11,121,9,"context"],[86,18,121,16],[87,2,122,0],[88,0,122,1],[88,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","useMemo$argument_0","hasPermission","hasRole","useAuth"],"mappings":"AAA;OCiE;YCG;GDE;8BEG;0BCG;KDI;oBEE;KFM;GFS;CDgB;OME;CNM"},"hasCjsExports":false},"type":"js/module"}]}