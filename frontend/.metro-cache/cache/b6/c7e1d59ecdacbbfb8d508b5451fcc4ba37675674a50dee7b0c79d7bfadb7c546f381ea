{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":88,"index":88}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../stores/authStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":89},"end":{"line":2,"column":51,"index":140}}],"key":"xZ94Y9XSSJKgtl1T0/yiI2QWZsY=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(); // Role hierarchy: owner > manager > staff\n  // Permission types\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _storesAuthStore = require(_dependencyMap[1], \"../stores/authStore\");\n  var _reactJsxDevRuntime = require(_dependencyMap[2], \"react/jsx-dev-runtime\");\n  // Add expenses\n\n  // Role-permission matrix\n  var rolePermissions = {\n    owner: ['manage_users', 'manage_company', 'view_audit_log', 'manage_budget', 'export_data', 'view_statistics', 'manage_invoices', 'add_revenue', 'add_expenses'],\n    manager: ['manage_budget', 'export_data', 'view_statistics', 'manage_invoices', 'add_revenue', 'add_expenses'],\n    staff: ['manage_invoices', 'add_revenue', 'add_expenses']\n  };\n  var AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider(_ref) {\n    _s();\n    var children = _ref.children;\n    var _useAuthStore = (0, _storesAuthStore.useAuthStore)(),\n      user = _useAuthStore.user,\n      isLoading = _useAuthStore.isLoading,\n      isAuthenticated = _useAuthStore.isAuthenticated,\n      login = _useAuthStore.login,\n      logout = _useAuthStore.logout,\n      checkAuth = _useAuthStore.checkAuth,\n      refreshUser = _useAuthStore.refreshUser,\n      setUser = _useAuthStore.setUser;\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, []);\n\n    // Role-based permission helpers\n    var roleHelpers = (0, _react.useMemo)(() => {\n      var userRole = user?.role || 'staff';\n      var hasPermission = permission => {\n        if (!user) return false;\n        var permissions = rolePermissions[userRole] || [];\n        return permissions.includes(permission);\n      };\n      var hasRole = role => {\n        if (!user) return false;\n        var roleHierarchy = ['owner', 'manager', 'staff'];\n        var userRoleIndex = roleHierarchy.indexOf(userRole);\n        var requiredRoleIndex = roleHierarchy.indexOf(role);\n        return userRoleIndex <= requiredRoleIndex;\n      };\n      return {\n        hasPermission,\n        hasRole,\n        isOwner: userRole === 'owner',\n        isManager: userRole === 'manager',\n        isStaff: userRole === 'staff'\n      };\n    }, [user]);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        isAuthenticated,\n        login,\n        logout,\n        refreshUser,\n        setUser,\n        ...roleHelpers\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }, this);\n  }\n  _s(AuthProvider, \"uQyUeBbKumNxgSvVbeSyZ2cZ2fU=\", false, function () {\n    return [_storesAuthStore.useAuthStore];\n  });\n  _c = AuthProvider;\n  function useAuth() {\n    _s2();\n    var context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n  _s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":97,"map":[[6,26,5,0],[7,2,8,0],[8,2,8,0,"Object"],[8,8,8,0],[8,9,8,0,"defineProperty"],[8,23,8,0],[8,24,8,0,"exports"],[8,31,8,0],[9,4,8,0,"value"],[9,9,8,0],[10,2,8,0],[11,2,66,0,"exports"],[11,9,66,0],[11,10,66,0,"AuthProvider"],[11,22,66,0],[11,25,66,0,"AuthProvider"],[11,37,66,0],[12,2,116,0,"exports"],[12,9,116,0],[12,10,116,0,"useAuth"],[12,17,116,0],[12,20,116,0,"useAuth"],[12,27,116,0],[13,2,1,0],[13,6,1,0,"_react"],[13,12,1,0],[13,15,1,0,"require"],[13,22,1,0],[13,23,1,0,"_dependencyMap"],[13,37,1,0],[14,2,2,0],[14,6,2,0,"_storesAuthStore"],[14,22,2,0],[14,25,2,0,"require"],[14,32,2,0],[14,33,2,0,"_dependencyMap"],[14,47,2,0],[15,2,2,51],[15,6,2,51,"_reactJsxDevRuntime"],[15,25,2,51],[15,28,2,51,"require"],[15,35,2,51],[15,36,2,51,"_dependencyMap"],[15,50,2,51],[16,2,18,24],[18,2,20,0],[19,2,21,0],[19,6,21,6,"rolePermissions"],[19,21,21,53],[19,24,21,56],[20,4,22,2,"owner"],[20,9,22,7],[20,11,22,9],[20,12,23,4],[20,26,23,18],[20,28,24,4],[20,44,24,20],[20,46,25,4],[20,62,25,20],[20,64,26,4],[20,79,26,19],[20,81,27,4],[20,94,27,17],[20,96,28,4],[20,113,28,21],[20,115,29,4],[20,132,29,21],[20,134,30,4],[20,147,30,17],[20,149,31,4],[20,163,31,18],[20,164,32,3],[21,4,33,2,"manager"],[21,11,33,9],[21,13,33,11],[21,14,34,4],[21,29,34,19],[21,31,35,4],[21,44,35,17],[21,46,36,4],[21,63,36,21],[21,65,37,4],[21,82,37,21],[21,84,38,4],[21,97,38,17],[21,99,39,4],[21,113,39,18],[21,114,40,3],[22,4,41,2,"staff"],[22,9,41,7],[22,11,41,9],[22,12,42,4],[22,29,42,21],[22,31,43,4],[22,44,43,17],[22,46,44,4],[22,60,44,18],[23,2,46,0],[23,3,46,1],[24,2,64,0],[24,6,64,6,"AuthContext"],[24,17,64,17],[24,33,64,20],[24,37,64,20,"createContext"],[24,43,64,33],[24,44,64,33,"createContext"],[24,57,64,33],[24,59,64,63,"undefined"],[24,68,64,72],[24,69,64,73],[25,2,66,7],[25,11,66,16,"AuthProvider"],[25,23,66,28,"AuthProvider"],[25,24,66,28,"_ref"],[25,28,66,28],[25,30,66,68],[26,4,66,68,"_s"],[26,6,66,68],[27,4,66,68],[27,8,66,31,"children"],[27,16,66,39],[27,19,66,39,"_ref"],[27,23,66,39],[27,24,66,31,"children"],[27,32,66,39],[28,4,67,2],[28,8,67,2,"_useAuthStore"],[28,21,67,2],[28,24,67,95],[28,28,67,95,"useAuthStore"],[28,44,67,107],[28,45,67,107,"useAuthStore"],[28,57,67,107],[28,59,67,108],[28,60,67,109],[29,6,67,10,"user"],[29,10,67,14],[29,13,67,14,"_useAuthStore"],[29,26,67,14],[29,27,67,10,"user"],[29,31,67,14],[30,6,67,16,"isLoading"],[30,15,67,25],[30,18,67,25,"_useAuthStore"],[30,31,67,25],[30,32,67,16,"isLoading"],[30,41,67,25],[31,6,67,27,"isAuthenticated"],[31,21,67,42],[31,24,67,42,"_useAuthStore"],[31,37,67,42],[31,38,67,27,"isAuthenticated"],[31,53,67,42],[32,6,67,44,"login"],[32,11,67,49],[32,14,67,49,"_useAuthStore"],[32,27,67,49],[32,28,67,44,"login"],[32,33,67,49],[33,6,67,51,"logout"],[33,12,67,57],[33,15,67,57,"_useAuthStore"],[33,28,67,57],[33,29,67,51,"logout"],[33,35,67,57],[34,6,67,59,"checkAuth"],[34,15,67,68],[34,18,67,68,"_useAuthStore"],[34,31,67,68],[34,32,67,59,"checkAuth"],[34,41,67,68],[35,6,67,70,"refreshUser"],[35,17,67,81],[35,20,67,81,"_useAuthStore"],[35,33,67,81],[35,34,67,70,"refreshUser"],[35,45,67,81],[36,6,67,83,"setUser"],[36,13,67,90],[36,16,67,90,"_useAuthStore"],[36,29,67,90],[36,30,67,83,"setUser"],[36,37,67,90],[37,4,69,2],[37,8,69,2,"useEffect"],[37,14,69,11],[37,15,69,11,"useEffect"],[37,24,69,11],[37,26,69,12],[37,32,69,18],[38,6,70,4,"checkAuth"],[38,15,70,13],[38,16,70,14],[38,17,70,15],[39,4,71,2],[39,5,71,3],[39,7,71,5],[39,9,71,7],[39,10,71,8],[41,4,73,2],[42,4,74,2],[42,8,74,8,"roleHelpers"],[42,19,74,19],[42,22,74,22],[42,26,74,22,"useMemo"],[42,32,74,29],[42,33,74,29,"useMemo"],[42,40,74,29],[42,42,74,30],[42,48,74,36],[43,6,75,4],[43,10,75,10,"userRole"],[43,18,75,18],[43,21,75,22,"user"],[43,25,75,26],[43,27,75,28,"role"],[43,31,75,32],[43,35,75,36],[43,42,75,56],[44,6,77,4],[44,10,77,10,"hasPermission"],[44,23,77,23],[44,26,77,27,"permission"],[44,36,77,49],[44,40,77,63],[45,8,78,6],[45,12,78,10],[45,13,78,11,"user"],[45,17,78,15],[45,19,78,17],[45,26,78,24],[45,31,78,29],[46,8,79,6],[46,12,79,12,"permissions"],[46,23,79,23],[46,26,79,26,"rolePermissions"],[46,41,79,41],[46,42,79,42,"userRole"],[46,50,79,50],[46,51,79,51],[46,55,79,55],[46,57,79,57],[47,8,80,6],[47,15,80,13,"permissions"],[47,26,80,24],[47,27,80,25,"includes"],[47,35,80,33],[47,36,80,34,"permission"],[47,46,80,44],[47,47,80,45],[48,6,81,4],[48,7,81,5],[49,6,83,4],[49,10,83,10,"hasRole"],[49,17,83,17],[49,20,83,21,"role"],[49,24,83,35],[49,28,83,49],[50,8,84,6],[50,12,84,10],[50,13,84,11,"user"],[50,17,84,15],[50,19,84,17],[50,26,84,24],[50,31,84,29],[51,8,85,6],[51,12,85,12,"roleHierarchy"],[51,25,85,37],[51,28,85,40],[51,29,85,41],[51,36,85,48],[51,38,85,50],[51,47,85,59],[51,49,85,61],[51,56,85,68],[51,57,85,69],[52,8,86,6],[52,12,86,12,"userRoleIndex"],[52,25,86,25],[52,28,86,28,"roleHierarchy"],[52,41,86,41],[52,42,86,42,"indexOf"],[52,49,86,49],[52,50,86,50,"userRole"],[52,58,86,58],[52,59,86,59],[53,8,87,6],[53,12,87,12,"requiredRoleIndex"],[53,29,87,29],[53,32,87,32,"roleHierarchy"],[53,45,87,45],[53,46,87,46,"indexOf"],[53,53,87,53],[53,54,87,54,"role"],[53,58,87,58],[53,59,87,59],[54,8,88,6],[54,15,88,13,"userRoleIndex"],[54,28,88,26],[54,32,88,30,"requiredRoleIndex"],[54,49,88,47],[55,6,89,4],[55,7,89,5],[56,6,91,4],[56,13,91,11],[57,8,92,6,"hasPermission"],[57,21,92,19],[58,8,93,6,"hasRole"],[58,15,93,13],[59,8,94,6,"isOwner"],[59,15,94,13],[59,17,94,15,"userRole"],[59,25,94,23],[59,30,94,28],[59,37,94,35],[60,8,95,6,"isManager"],[60,17,95,15],[60,19,95,17,"userRole"],[60,27,95,25],[60,32,95,30],[60,41,95,39],[61,8,96,6,"isStaff"],[61,15,96,13],[61,17,96,15,"userRole"],[61,25,96,23],[61,30,96,28],[62,6,97,4],[62,7,97,5],[63,4,98,2],[63,5,98,3],[63,7,98,5],[63,8,98,6,"user"],[63,12,98,10],[63,13,98,11],[63,14,98,12],[64,4,100,2],[64,24,101,4],[64,28,101,4,"_reactJsxDevRuntime"],[64,47,101,4],[64,48,101,4,"jsxDEV"],[64,54,101,4],[64,56,101,5,"AuthContext"],[64,67,101,16],[64,68,101,17,"Provider"],[64,76,101,25],[65,6,101,26,"value"],[65,11,101,31],[65,13,101,33],[66,8,102,6,"user"],[66,12,102,10],[67,8,103,6,"isLoading"],[67,17,103,15],[68,8,104,6,"isAuthenticated"],[68,23,104,21],[69,8,105,6,"login"],[69,13,105,11],[70,8,106,6,"logout"],[70,14,106,12],[71,8,107,6,"refreshUser"],[71,19,107,17],[72,8,108,6,"setUser"],[72,15,108,13],[73,8,109,6],[73,11,109,9,"roleHelpers"],[74,6,110,4],[74,7,110,6],[75,6,110,6,"children"],[75,14,110,6],[75,16,111,7,"children"],[76,4,111,15],[77,6,111,15,"fileName"],[77,14,111,15],[77,16,111,15,"_jsxFileName"],[77,28,111,15],[78,6,111,15,"lineNumber"],[78,16,111,15],[79,6,111,15,"columnNumber"],[79,18,111,15],[80,4,111,15],[80,11,112,26],[80,12,112,27],[81,2,114,0],[82,2,114,1,"_s"],[82,4,114,1],[82,5,66,16,"AuthProvider"],[82,17,66,28],[83,4,66,28],[83,12,67,95,"useAuthStore"],[83,28,67,107],[83,29,67,107,"useAuthStore"],[83,41,67,107],[84,2,67,107],[85,2,67,107,"_c"],[85,4,67,107],[85,7,66,16,"AuthProvider"],[85,19,66,28],[86,2,116,7],[86,11,116,16,"useAuth"],[86,18,116,23,"useAuth"],[86,19,116,23],[86,21,116,26],[87,4,116,26,"_s2"],[87,7,116,26],[88,4,117,2],[88,8,117,8,"context"],[88,15,117,15],[88,18,117,18],[88,22,117,18,"useContext"],[88,28,117,28],[88,29,117,28,"useContext"],[88,39,117,28],[88,41,117,29,"AuthContext"],[88,52,117,40],[88,53,117,41],[89,4,118,2],[89,8,118,6,"context"],[89,15,118,13],[89,20,118,18,"undefined"],[89,29,118,27],[89,31,118,29],[90,6,119,4],[90,12,119,10],[90,16,119,14,"Error"],[90,21,119,19],[90,22,119,20],[90,67,119,65],[90,68,119,66],[91,4,120,2],[92,4,121,2],[92,11,121,9,"context"],[92,18,121,16],[93,2,122,0],[94,2,122,1,"_s2"],[94,5,122,1],[94,6,116,16,"useAuth"],[94,13,116,23],[95,2,116,23],[95,6,116,23,"_c"],[95,8,116,23],[96,2,116,23,"$RefreshReg$"],[96,14,116,23],[96,15,116,23,"_c"],[96,17,116,23],[97,0,116,23],[97,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","useMemo$argument_0","hasPermission","hasRole","useAuth"],"mappings":"AAA;OCiE;YCG;GDE;8BEG;0BCG;KDI;oBEE;KFM;GFS;CDgB;OME;CNM"},"hasCjsExports":false},"type":"js/module"}]}