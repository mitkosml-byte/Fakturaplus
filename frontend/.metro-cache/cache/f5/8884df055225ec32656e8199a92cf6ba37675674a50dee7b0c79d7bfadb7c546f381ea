{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":88,"index":88}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../stores/authStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":89},"end":{"line":2,"column":51,"index":140}}],"key":"xZ94Y9XSSJKgtl1T0/yiI2QWZsY=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(); // Role hierarchy: owner > manager > staff\n  // Permission types\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _storesAuthStore = require(_dependencyMap[1], \"../stores/authStore\");\n  var _reactJsxDevRuntime = require(_dependencyMap[2], \"react/jsx-dev-runtime\");\n  // Add expenses\n\n  // Role-permission matrix\n  const rolePermissions = {\n    owner: ['manage_users', 'manage_company', 'view_audit_log', 'manage_budget', 'export_data', 'view_statistics', 'manage_invoices', 'add_revenue', 'add_expenses'],\n    manager: ['manage_budget', 'export_data', 'view_statistics', 'manage_invoices', 'add_revenue', 'add_expenses'],\n    staff: ['manage_invoices', 'add_revenue', 'add_expenses']\n  };\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider({\n    children\n  }) {\n    _s();\n    const {\n      user,\n      isLoading,\n      isAuthenticated,\n      login,\n      logout,\n      checkAuth,\n      refreshUser,\n      setUser\n    } = (0, _storesAuthStore.useAuthStore)();\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, []);\n\n    // Role-based permission helpers\n    const roleHelpers = (0, _react.useMemo)(() => {\n      const userRole = user?.role || 'staff';\n      const hasPermission = permission => {\n        if (!user) return false;\n        const permissions = rolePermissions[userRole] || [];\n        return permissions.includes(permission);\n      };\n      const hasRole = role => {\n        if (!user) return false;\n        const roleHierarchy = ['owner', 'manager', 'staff'];\n        const userRoleIndex = roleHierarchy.indexOf(userRole);\n        const requiredRoleIndex = roleHierarchy.indexOf(role);\n        return userRoleIndex <= requiredRoleIndex;\n      };\n      return {\n        hasPermission,\n        hasRole,\n        isOwner: userRole === 'owner',\n        isManager: userRole === 'manager',\n        isStaff: userRole === 'staff'\n      };\n    }, [user]);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: Object.assign({\n        user,\n        isLoading,\n        isAuthenticated,\n        login,\n        logout,\n        refreshUser,\n        setUser\n      }, roleHelpers),\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }, this);\n  }\n  _s(AuthProvider, \"uQyUeBbKumNxgSvVbeSyZ2cZ2fU=\", false, function () {\n    return [_storesAuthStore.useAuthStore];\n  });\n  _c = AuthProvider;\n  function useAuth() {\n    _s2();\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n  _s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":98,"map":[[6,26,5,0],[7,2,8,0],[8,2,8,0,"Object"],[8,8,8,0],[8,9,8,0,"defineProperty"],[8,23,8,0],[8,24,8,0,"exports"],[8,31,8,0],[9,4,8,0,"value"],[9,9,8,0],[10,2,8,0],[11,2,66,0,"exports"],[11,9,66,0],[11,10,66,0,"AuthProvider"],[11,22,66,0],[11,25,66,0,"AuthProvider"],[11,37,66,0],[12,2,116,0,"exports"],[12,9,116,0],[12,10,116,0,"useAuth"],[12,17,116,0],[12,20,116,0,"useAuth"],[12,27,116,0],[13,2,1,0],[13,6,1,0,"_react"],[13,12,1,0],[13,15,1,0,"require"],[13,22,1,0],[13,23,1,0,"_dependencyMap"],[13,37,1,0],[14,2,2,0],[14,6,2,0,"_storesAuthStore"],[14,22,2,0],[14,25,2,0,"require"],[14,32,2,0],[14,33,2,0,"_dependencyMap"],[14,47,2,0],[15,2,2,51],[15,6,2,51,"_reactJsxDevRuntime"],[15,25,2,51],[15,28,2,51,"require"],[15,35,2,51],[15,36,2,51,"_dependencyMap"],[15,50,2,51],[16,2,18,24],[18,2,20,0],[19,2,21,0],[19,8,21,6,"rolePermissions"],[19,23,21,53],[19,26,21,56],[20,4,22,2,"owner"],[20,9,22,7],[20,11,22,9],[20,12,23,4],[20,26,23,18],[20,28,24,4],[20,44,24,20],[20,46,25,4],[20,62,25,20],[20,64,26,4],[20,79,26,19],[20,81,27,4],[20,94,27,17],[20,96,28,4],[20,113,28,21],[20,115,29,4],[20,132,29,21],[20,134,30,4],[20,147,30,17],[20,149,31,4],[20,163,31,18],[20,164,32,3],[21,4,33,2,"manager"],[21,11,33,9],[21,13,33,11],[21,14,34,4],[21,29,34,19],[21,31,35,4],[21,44,35,17],[21,46,36,4],[21,63,36,21],[21,65,37,4],[21,82,37,21],[21,84,38,4],[21,97,38,17],[21,99,39,4],[21,113,39,18],[21,114,40,3],[22,4,41,2,"staff"],[22,9,41,7],[22,11,41,9],[22,12,42,4],[22,29,42,21],[22,31,43,4],[22,44,43,17],[22,46,44,4],[22,60,44,18],[23,2,46,0],[23,3,46,1],[24,2,64,0],[24,8,64,6,"AuthContext"],[24,19,64,17],[24,35,64,20],[24,39,64,20,"createContext"],[24,45,64,33],[24,46,64,33,"createContext"],[24,59,64,33],[24,61,64,63,"undefined"],[24,70,64,72],[24,71,64,73],[25,2,66,7],[25,11,66,16,"AuthProvider"],[25,23,66,28,"AuthProvider"],[25,24,66,29],[26,4,66,31,"children"],[27,2,66,65],[27,3,66,66],[27,5,66,68],[28,4,66,68,"_s"],[28,6,66,68],[29,4,67,2],[29,10,67,8],[30,6,67,10,"user"],[30,10,67,14],[31,6,67,16,"isLoading"],[31,15,67,25],[32,6,67,27,"isAuthenticated"],[32,21,67,42],[33,6,67,44,"login"],[33,11,67,49],[34,6,67,51,"logout"],[34,12,67,57],[35,6,67,59,"checkAuth"],[35,15,67,68],[36,6,67,70,"refreshUser"],[36,17,67,81],[37,6,67,83,"setUser"],[38,4,67,91],[38,5,67,92],[38,8,67,95],[38,12,67,95,"useAuthStore"],[38,28,67,107],[38,29,67,107,"useAuthStore"],[38,41,67,107],[38,43,67,108],[38,44,67,109],[39,4,69,2],[39,8,69,2,"useEffect"],[39,14,69,11],[39,15,69,11,"useEffect"],[39,24,69,11],[39,26,69,12],[39,32,69,18],[40,6,70,4,"checkAuth"],[40,15,70,13],[40,16,70,14],[40,17,70,15],[41,4,71,2],[41,5,71,3],[41,7,71,5],[41,9,71,7],[41,10,71,8],[43,4,73,2],[44,4,74,2],[44,10,74,8,"roleHelpers"],[44,21,74,19],[44,24,74,22],[44,28,74,22,"useMemo"],[44,34,74,29],[44,35,74,29,"useMemo"],[44,42,74,29],[44,44,74,30],[44,50,74,36],[45,6,75,4],[45,12,75,10,"userRole"],[45,20,75,18],[45,23,75,22,"user"],[45,27,75,26],[45,29,75,28,"role"],[45,33,75,32],[45,37,75,36],[45,44,75,56],[46,6,77,4],[46,12,77,10,"hasPermission"],[46,25,77,23],[46,28,77,27,"permission"],[46,38,77,49],[46,42,77,63],[47,8,78,6],[47,12,78,10],[47,13,78,11,"user"],[47,17,78,15],[47,19,78,17],[47,26,78,24],[47,31,78,29],[48,8,79,6],[48,14,79,12,"permissions"],[48,25,79,23],[48,28,79,26,"rolePermissions"],[48,43,79,41],[48,44,79,42,"userRole"],[48,52,79,50],[48,53,79,51],[48,57,79,55],[48,59,79,57],[49,8,80,6],[49,15,80,13,"permissions"],[49,26,80,24],[49,27,80,25,"includes"],[49,35,80,33],[49,36,80,34,"permission"],[49,46,80,44],[49,47,80,45],[50,6,81,4],[50,7,81,5],[51,6,83,4],[51,12,83,10,"hasRole"],[51,19,83,17],[51,22,83,21,"role"],[51,26,83,35],[51,30,83,49],[52,8,84,6],[52,12,84,10],[52,13,84,11,"user"],[52,17,84,15],[52,19,84,17],[52,26,84,24],[52,31,84,29],[53,8,85,6],[53,14,85,12,"roleHierarchy"],[53,27,85,37],[53,30,85,40],[53,31,85,41],[53,38,85,48],[53,40,85,50],[53,49,85,59],[53,51,85,61],[53,58,85,68],[53,59,85,69],[54,8,86,6],[54,14,86,12,"userRoleIndex"],[54,27,86,25],[54,30,86,28,"roleHierarchy"],[54,43,86,41],[54,44,86,42,"indexOf"],[54,51,86,49],[54,52,86,50,"userRole"],[54,60,86,58],[54,61,86,59],[55,8,87,6],[55,14,87,12,"requiredRoleIndex"],[55,31,87,29],[55,34,87,32,"roleHierarchy"],[55,47,87,45],[55,48,87,46,"indexOf"],[55,55,87,53],[55,56,87,54,"role"],[55,60,87,58],[55,61,87,59],[56,8,88,6],[56,15,88,13,"userRoleIndex"],[56,28,88,26],[56,32,88,30,"requiredRoleIndex"],[56,49,88,47],[57,6,89,4],[57,7,89,5],[58,6,91,4],[58,13,91,11],[59,8,92,6,"hasPermission"],[59,21,92,19],[60,8,93,6,"hasRole"],[60,15,93,13],[61,8,94,6,"isOwner"],[61,15,94,13],[61,17,94,15,"userRole"],[61,25,94,23],[61,30,94,28],[61,37,94,35],[62,8,95,6,"isManager"],[62,17,95,15],[62,19,95,17,"userRole"],[62,27,95,25],[62,32,95,30],[62,41,95,39],[63,8,96,6,"isStaff"],[63,15,96,13],[63,17,96,15,"userRole"],[63,25,96,23],[63,30,96,28],[64,6,97,4],[64,7,97,5],[65,4,98,2],[65,5,98,3],[65,7,98,5],[65,8,98,6,"user"],[65,12,98,10],[65,13,98,11],[65,14,98,12],[66,4,100,2],[66,24,101,4],[66,28,101,4,"_reactJsxDevRuntime"],[66,47,101,4],[66,48,101,4,"jsxDEV"],[66,54,101,4],[66,56,101,5,"AuthContext"],[66,67,101,16],[66,68,101,17,"Provider"],[66,76,101,25],[67,6,101,26,"value"],[67,11,101,31],[67,13,101,31,"Object"],[67,19,101,31],[67,20,101,31,"assign"],[67,26,101,31],[68,8,102,6,"user"],[68,12,102,10],[69,8,103,6,"isLoading"],[69,17,103,15],[70,8,104,6,"isAuthenticated"],[70,23,104,21],[71,8,105,6,"login"],[71,13,105,11],[72,8,106,6,"logout"],[72,14,106,12],[73,8,107,6,"refreshUser"],[73,19,107,17],[74,8,108,6,"setUser"],[75,6,108,13],[75,9,109,9,"roleHelpers"],[75,20,109,20],[75,21,110,6],[76,6,110,6,"children"],[76,14,110,6],[76,16,111,7,"children"],[77,4,111,15],[78,6,111,15,"fileName"],[78,14,111,15],[78,16,111,15,"_jsxFileName"],[78,28,111,15],[79,6,111,15,"lineNumber"],[79,16,111,15],[80,6,111,15,"columnNumber"],[80,18,111,15],[81,4,111,15],[81,11,112,26],[81,12,112,27],[82,2,114,0],[83,2,114,1,"_s"],[83,4,114,1],[83,5,66,16,"AuthProvider"],[83,17,66,28],[84,4,66,28],[84,12,67,95,"useAuthStore"],[84,28,67,107],[84,29,67,107,"useAuthStore"],[84,41,67,107],[85,2,67,107],[86,2,67,107,"_c"],[86,4,67,107],[86,7,66,16,"AuthProvider"],[86,19,66,28],[87,2,116,7],[87,11,116,16,"useAuth"],[87,18,116,23,"useAuth"],[87,19,116,23],[87,21,116,26],[88,4,116,26,"_s2"],[88,7,116,26],[89,4,117,2],[89,10,117,8,"context"],[89,17,117,15],[89,20,117,18],[89,24,117,18,"useContext"],[89,30,117,28],[89,31,117,28,"useContext"],[89,41,117,28],[89,43,117,29,"AuthContext"],[89,54,117,40],[89,55,117,41],[90,4,118,2],[90,8,118,6,"context"],[90,15,118,13],[90,20,118,18,"undefined"],[90,29,118,27],[90,31,118,29],[91,6,119,4],[91,12,119,10],[91,16,119,14,"Error"],[91,21,119,19],[91,22,119,20],[91,67,119,65],[91,68,119,66],[92,4,120,2],[93,4,121,2],[93,11,121,9,"context"],[93,18,121,16],[94,2,122,0],[95,2,122,1,"_s2"],[95,5,122,1],[95,6,116,16,"useAuth"],[95,13,116,23],[96,2,116,23],[96,6,116,23,"_c"],[96,8,116,23],[97,2,116,23,"$RefreshReg$"],[97,14,116,23],[97,15,116,23,"_c"],[97,17,116,23],[98,0,116,23],[98,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","useMemo$argument_0","hasPermission","hasRole","useAuth"],"mappings":"AAA;OCiE;YCG;GDE;8BEG;0BCG;KDI;oBEE;KFM;GFS;CDgB;OME;CNM"},"hasCjsExports":false},"type":"js/module"}]}